"use strict";(self.webpackChunkalova_website=self.webpackChunkalova_website||[]).push([[1116],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>h});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var i=n.createContext({}),u=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},d=function(e){var t=u(e.components);return n.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=u(a),h=o,m=p["".concat(i,".").concat(h)]||p[h]||c[h]||s;return a?n.createElement(m,r(r({ref:t},d),{},{components:a})):n.createElement(m,r({ref:t},d))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=a.length,r=new Array(s);r[0]=p;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var u=2;u<s;u++)r[u]=a[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(7294),o=a(6010);const s="tabItem_Ymn6";function r(e){let{children:t,hidden:a,className:r}=e;return n.createElement("div",{role:"tabpanel",className:(0,o.Z)(s,r),hidden:a},t)}},4866:(e,t,a)=>{a.d(t,{Z:()=>T});var n=a(7462),o=a(7294),s=a(6010),r=a(2466),l=a(6550),i=a(1980),u=a(7392),d=a(12);function c(e){return function(e){var t;return(null==(t=o.Children.map(e,(e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})))?void 0:t.filter(Boolean))??[]}(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:o}}=e;return{value:t,label:a,attributes:n,default:o}}))}function p(e){const{values:t,children:a}=e;return(0,o.useMemo)((()=>{const e=t??c(a);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function h(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:a}=e;const n=(0,l.k6)(),s=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,i._X)(s),(0,o.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(n.location.search);t.set(s,e),n.replace({...n.location,search:t.toString()})}),[s,n])]}function g(e){const{defaultValue:t,queryString:a=!1,groupId:n}=e,s=p(e),[r,l]=(0,o.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:s}))),[i,u]=m({queryString:a,groupId:n}),[c,g]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,s]=(0,d.Nk)(a);return[n,(0,o.useCallback)((e=>{a&&s.set(e)}),[a,s])]}({groupId:n}),f=(()=>{const e=i??c;return h({value:e,tabValues:s})?e:null})();(0,o.useLayoutEffect)((()=>{f&&l(f)}),[f]);return{selectedValue:r,selectValue:(0,o.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),g(e)}),[u,g,s]),tabValues:s}}var f=a(2389);const b="tabList__CuJ",v="tabItem_LNqP";function y(e){let{className:t,block:a,selectedValue:l,selectValue:i,tabValues:u}=e;const d=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.o5)(),p=e=>{const t=e.currentTarget,a=d.indexOf(t),n=u[a].value;n!==l&&(c(t),i(n))},h=e=>{var t;let a=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const t=d.indexOf(e.currentTarget)+1;a=d[t]??d[0];break}case"ArrowLeft":{const t=d.indexOf(e.currentTarget)-1;a=d[t]??d[d.length-1];break}}null==(t=a)||t.focus()};return o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":a},t)},u.map((e=>{let{value:t,label:a,attributes:r}=e;return o.createElement("li",(0,n.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>d.push(e),onKeyDown:h,onClick:p},r,{className:(0,s.Z)("tabs__item",v,null==r?void 0:r.className,{"tabs__item--active":l===t})}),a??t)})))}function w(e){let{lazy:t,children:a,selectedValue:n}=e;const s=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===n));return e?(0,o.cloneElement)(e,{className:"margin-top--md"}):null}return o.createElement("div",{className:"margin-top--md"},s.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function k(e){const t=g(e);return o.createElement("div",{className:(0,s.Z)("tabs-container",b)},o.createElement(y,(0,n.Z)({},e,t)),o.createElement(w,(0,n.Z)({},e,t)))}function T(e){const t=(0,f.Z)();return o.createElement(k,(0,n.Z)({key:String(t)},e))}},2341:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>u,toc:()=>c});var n=a(7462),o=(a(7294),a(3905)),s=a(4866),r=a(5162);const l={title:"Manage additional state",sidebar_position:60},i=void 0,u={unversionedId:"next-step/manage-extra-states",id:"next-step/manage-extra-states",title:"Manage additional state",description:"In the previous [Cross Page/Module Update Response Status] (/learning/update-response-data-across-modules) chapter, we introduced how to update the response status across pages or modules, but in this chapter we It only introduces updating the data state returned by useRequest and useWatcher through updateState, the value of data is always consistent with the response data, but in many cases we will use additional states(such as state A) to display data, and After the request is successful, the data data is appended to the additional state A, such as the pagination scheme of pull-down loading. In this case, we need to manage the additional state A so that it can be updated across pages/modules.",source:"@site/docs/06-next-step/07-manage-extra-states.md",sourceDirName:"06-next-step",slug:"/next-step/manage-extra-states",permalink:"/next-step/manage-extra-states",draft:!1,editUrl:"https://github.com/alovajs/alovajs.github.io/blob/main/docs/06-next-step/07-manage-extra-states.md",tags:[],version:"current",sidebarPosition:60,frontMatter:{title:"Manage additional state",sidebar_position:60},sidebar:"tutorialSidebar",previous:{title:"Automatic cache invalidation",permalink:"/next-step/auto-invalidate-cache"},next:{title:"Parallel Requests",permalink:"/next-step/parallel-request"}},d={},c=[{value:"Update a single state",id:"update-a-single-state",level:2},{value:"Update multiple states",id:"update-multiple-states",level:2},{value:"shorthand for data status update",id:"shorthand-for-data-status-update",level:2}],p={toc:c};function h(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"In the previous ","[Cross Page/Module Update Response Status]"," (/learning/update-response-data-across-modules) chapter, we introduced how to update the response status across pages or modules, but in this chapter we It only introduces updating the ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," state returned by ",(0,o.kt)("inlineCode",{parentName:"p"},"useRequest")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"useWatcher")," through ",(0,o.kt)("inlineCode",{parentName:"p"},"updateState"),", the value of data is always consistent with the response data, but in many cases we will use additional states(such as state A) to display data, and After the request is successful, the data data is appended to the additional state A, such as the pagination scheme of pull-down loading. In this case, we need to manage the additional state A so that it can be updated across pages/modules."),(0,o.kt)("h2",{id:"update-a-single-state"},"Update a single state"),(0,o.kt)("p",null,"Additional states can be managed via ",(0,o.kt)("inlineCode",{parentName:"p"},"managedStates")," when called by the use hook, and automatically assigned the state name to update it when ",(0,o.kt)("inlineCode",{parentName:"p"},"updateState")," is called in other modules/pages."),(0,o.kt)(s.Z,{groupId:"framework",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"1",label:"vue",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// a.vue\nconst todoList = page =>\n  alova.Get('/todo', {\n    name: 'todoList'\n  });\n\nconst allTodo = ref([]);\nuseRequest(todoList, {\n  //...\n\n  // highlight-start\n  // manage allTodo as additional state\n  managedStates: {\n    allTodo\n  }\n  // highlight-end\n});\n\n// b.vue\n//...\nconst handleSuccess = () => {\n  // highlight-start\n  // Pass in an object and specify the state name to look up\n  updateState('todoList', {\n    allTodo: allTodoData => {\n      // Add a new todo item\n      allTodoData.push({\n        title: 'new todo',\n        time: '10:00'\n      });\n      return allTodoData;\n    }\n  });\n  // highlight-end\n};\n"))),(0,o.kt)(r.Z,{value:"2",label:"react",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// a.jsx\nconst PageA = () => {\n   const todoList = page =>\n     alova. Get('/todo', {\n       name: 'todoList'\n     });\n\n   const [allTodo, setAllTodo] = allTodoState = useState([]);\n   useRequest(todoList, {\n     //...\n\n     // highlight-start\n     // manage allTodo as additional state\n     managedStates: {\n       allTodo: allTodoState\n     }\n     // highlight-end\n   });\n\n   return (\n     //...\n   );\n}\n\n// b.jsx\nconst PageB = () => {\n   //...\n   const handleSuccess = () => {\n     // highlight-start\n     // Pass in an object and specify the state name to look up\n     updateState('todoList', {\n       allTodo: allTodoData => {\n         // Add a new todo item\n         allTodoData. push({\n           title: 'new todo',\n           time: '10:00'\n         });\n         return allTodoData;\n       }\n     });\n     // highlight-end\n   };\n\n   return (\n     //...\n   );\n}\n"))),(0,o.kt)(r.Z,{value:"3",label:"svelte",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// a. svelte\nconst todoList = page =>\n  alova.Get('/todo', {\n    name: 'todoList'\n  });\n\nconst allTodo = ref([]);\nuseRequest(todoList, {\n  //...\n\n  // highlight-start\n  // manage allTodo as additional state\n  managedStates: {\n    allTodo\n  }\n  // highlight-end\n});\n\n// b. svelte\n//...\nconst handleSuccess = () => {\n  // highlight-start\n  // Pass in an object and specify the state name to look up\n  updateState('todoList', {\n    allTodo: allTodoData => {\n      // Add a new todo item\n      allTodoData.push({\n        title: 'new todo',\n        time: '10:00'\n      });\n      return allTodoData;\n    }\n  });\n  // highlight-end\n};\n")))),(0,o.kt)("h2",{id:"update-multiple-states"},"Update multiple states"),(0,o.kt)("p",null,"In the above example, we implemented the update of a single ",(0,o.kt)("inlineCode",{parentName:"p"},"allTodo")," state across pages. In fact, any number of states can be updated at the same time through the object description method of ",(0,o.kt)("inlineCode",{parentName:"p"},"updateState"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"updateState('todoList', {\n  state1: state1Data => {\n    //...\n  },\n  state2: state2Data => {\n    //...\n  },\n  state3: state3Data => {\n    //...\n  }\n  //...\n});\n")),(0,o.kt)("p",null,"It should be noted that the above 3 additional states need to be managed through the ",(0,o.kt)("inlineCode",{parentName:"p"},"managedStates")," property before updating."),(0,o.kt)("h2",{id:"shorthand-for-data-status-update"},"shorthand for data status update"),(0,o.kt)("p",null,"When only updating the data state, you can directly pass in the callback function instead of specifying it as an object."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"updateState('todoList', {\n  data: dataRaw => {\n    //...\n  }\n});\n\n// The following are shorthand\nupdateState('todoList', dataRaw => {\n  //...\n});\n")))}h.isMDXComponent=!0}}]);