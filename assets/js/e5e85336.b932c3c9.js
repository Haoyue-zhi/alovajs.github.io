"use strict";(self.webpackChunkalova_website=self.webpackChunkalova_website||[]).push([[3903],{62701:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>h});var a=n(85893),i=n(11151),s=n(74866),r=n(85162);const l={title:"Pagination request strategy"},d=void 0,o={id:"tutorial/client/strategy/use-pagination",title:"Pagination request strategy",description:"use hook",source:"@site/docs/tutorial/03-client/01-strategy/04-use-pagination.md",sourceDirName:"tutorial/03-client/01-strategy",slug:"/tutorial/client/strategy/use-pagination",permalink:"/next/tutorial/client/strategy/use-pagination",draft:!1,unlisted:!1,editUrl:"https://github.com/alovajs/alovajs.github.io/blob/main/docs/tutorial/03-client/01-strategy/04-use-pagination.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Pagination request strategy"},sidebar:"tutorial",previous:{title:"Fetch Data",permalink:"/next/tutorial/client/strategy/use-fetcher"},next:{title:"Form submiting strategy",permalink:"/next/tutorial/client/strategy/use-form"}},c={},h=[{value:"Features",id:"features",level:2},{value:"Usage",id:"usage",level:2},{value:"Render list data",id:"render-list-data",level:3},{value:"Specify pagination data",id:"specify-pagination-data",level:3},{value:"Enable append mode",id:"enable-append-mode",level:3},{value:"Preload adjacent page data",id:"preload-adjacent-page-data",level:3},{value:"Listening filter conditions",id:"listening-filter-conditions",level:3},{value:"Close initialization request",id:"close-initialization-request",level:3},{value:"List action functions",id:"list-action-functions",level:2},{value:"Insert list item",id:"insert-list-item",level:3},{value:"Remove list item",id:"remove-list-item",level:3},{value:"Update data items",id:"update-data-items",level:3},{value:"Refresh the data of the specified page",id:"refresh-the-data-of-the-specified-page",level:3},{value:"Manually update list data",id:"manually-update-list-data",level:3},{value:"Reset list",id:"reset-list",level:3},{value:"API",id:"api",level:2},{value:"Hook configuration",id:"hook-configuration",level:3},{value:"Responsive data",id:"responsive-data",level:3},{value:"Action function",id:"action-function",level:3},{value:"Event",id:"event",level:3}];function u(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.admonition,{title:"stragety type",type:"info",children:(0,a.jsx)(t.p,{children:"use hook"})}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"Before using extension hooks, make sure you are familiar with basic usage of alova."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"A hook designed for paging scenarios, which can help you automatically manage paging data, preload data, reduce unnecessary data refresh, improve fluency by 300%, and reduce coding difficulty by 50%**. You can use it in the two paging scenarios of pull-down loading and page number flipping. This hook provides a wealth of features to help your application create better performance and more convenient paging functions."}),"\n",(0,a.jsx)(t.h2,{id:"features",children:"Features"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Rich and comprehensive paging status;"}),"\n",(0,a.jsx)(t.li,{children:"Rich and comprehensive pagination events;"}),"\n",(0,a.jsx)(t.li,{children:"Change page, pageSize to automatically get specified paging data;"}),"\n",(0,a.jsx)(t.li,{children:"Data caching, no need to repeatedly request list data of the same parameters;"}),"\n",(0,a.jsx)(t.li,{children:"Front and back pages are preloaded, no waiting for page turning;"}),"\n",(0,a.jsx)(t.li,{children:"Search condition monitoring automatically reacquires pages;"}),"\n",(0,a.jsx)(t.li,{children:"Support adding, editing and deleting list data;"}),"\n",(0,a.jsx)(t.li,{children:"Support refreshing the data of the specified page without reset;"}),"\n",(0,a.jsx)(t.li,{children:"Request-level search anti-shake, no need to maintain by yourself;"}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsx)(t.h3,{id:"render-list-data",children:"Render list data"}),"\n",(0,a.jsxs)(s.Z,{groupId:"framework",children:[(0,a.jsx)(r.Z,{value:"1",label:"vue composition",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'<template>\n  <div\n    v-for="item in data"\n    :key="item.id">\n    <span>{{ item.name }}</span>\n  </div>\n  <button @click="handlePrevPage">Previous page</button>\n  <button @click="handleNextPage">next page</button>\n  <button @click="handleSetPageSize">Set the number of pages</button>\n  <span>There are {{ pageCount }} pages</span>\n  <span>A total of {{ total }} data</span>\n</template>\n\n<script setup>\n  import { queryStudents } from \'./api.js\';\n  import { usePagination } from \'alova/client\';\n\n  const {\n    // loading state\n    loading,\n\n    // list data\n    data,\n\n    // is it the last page\n    // This parameter can be used to determine whether it needs to be loaded during pull-down loading\n    isLastPage,\n\n    // The current page number, changing this page number will automatically trigger the request\n    page,\n\n    // Number of data items per page\n    pageSize,\n\n    // number of paging pages\n    pageCount,\n\n    // total amount of data\n    total\n  } = usePagination(\n    // Method instance acquisition function, it will receive page and pageSize, and return a Method instance\n    (page, pageSize) => queryStudents(page, pageSize),\n    {\n      // Initial data before the request (data format returned by the interface)\n      initialData: {\n        total: 0,\n        data: []\n      },\n      initialPage: 1, // initial page number, default is 1\n      initialPageSize: 10 // The initial number of data items per page, the default is 10\n    }\n  );\n\n  // Turn to the previous page, the request will be sent automatically after the page value changes\n  const handlePrevPage = () => {\n    page.value--;\n  };\n\n  // Turn to the next page, the request will be sent automatically after the page value changes\n  const handleNextPage = () => {\n    page.value++;\n  };\n\n  // Change the number of pages, the request will be sent automatically after the pageSize value is changed\n  const handleSetPageSize = () => {\n    pageSize.value = 20;\n  };\n<\/script>\n'})})}),(0,a.jsx)(r.Z,{value:"2",label:"react",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-jsx",children:"import { queryStudents } from './api.js';\nimport { usePagination } from 'alova/client';\n\nconst App = () => {\n  const {\n    // loading state\n    loading,\n\n    // list data\n    data,\n\n    // is it the last page\n    // This parameter can be used to determine whether it needs to be loaded during pull-down loading\n    isLastPage,\n\n    // The current page number, changing this page number will automatically trigger the request\n    page,\n\n    // Number of data items per page\n    pageSize,\n\n    // number of paging pages\n    pageCount,\n\n    // total amount of data\n    total\uff0c\n\n    // update states\n    update\n  } = usePagination(\n    // Method instance acquisition function, it will receive page and pageSize, and return a Method instance\n    (page, pageSize) => queryStudents(page, pageSize),\n    {\n      // Initial data before the request (data format returned by the interface)\n      initialData: {\n        total: 0,\n        data: []\n      },\n      initialPage: 1, // initial page number, default is 1\n      initialPageSize: 10 // The initial number of data items per page, the default is 10\n    }\n  );\n\n  // Turn to the previous page, the request will be sent automatically after the page value changes\n  const handlePrevPage = () => {\n    update({\n      page: page - 1\n    });\n  };\n\n  // Turn to the next page, the request will be sent automatically after the page value changes\n  const handleNextPage = () => {\n    update({\n      page: page + 1\n    });\n  };\n\n  // Change the number of pages, the request will be sent automatically after the pageSize value is changed\n  const handleSetPageSize = () => {\n    update({\n      pageSize: 20\n    });\n  };\n\n  return (\n    <div>\n      {data.map(item => (\n        <div key={item.id}>\n          <span>{item.name}</span>\n        </div>\n      ))}\n      <button onClick={handlePrevPage}>Previous page</button>\n      <button onClick={handleNextPage}>Next Page</button>\n      <button onClick={handleSetPageSize}>Set the number per page</button>\n      <span>There are {pageCount} pages</span>\n      <span>A total of {total} pieces of data</span>\n    </div>\n  );\n};\n"})})}),(0,a.jsx)(r.Z,{value:"3",label:"svelte",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'<script>\n  import { queryStudents } from \'./api.js\';\n  import { usePagination } from \'alova/client\';\n\n  const {\n    // loading state\n    loading,\n\n    // list data\n    data,\n\n    // is it the last page\n    // This parameter can be used to determine whether it needs to be loaded during pull-down loading\n    isLastPage,\n\n    // The current page number, changing this page number will automatically trigger the request\n    page,\n\n    // Number of data items per page\n    pageSize,\n\n    // number of paging pages\n    pageCount,\n\n    // total amount of data\n    total\n  } = usePagination(\n    // Method instance acquisition function, it will receive page and pageSize, and return a Method instance\n    (page, pageSize) => queryStudents(page, pageSize),\n    {\n      // Initial data before the request (data format returned by the interface)\n      initialData: {\n        total: 0,\n        data: []\n      },\n      initialPage: 1, // initial page number, default is 1\n      initialPageSize: 10 // The initial number of data items per page, the default is 10\n    }\n  );\n\n  // Turn to the previous page, the request will be sent automatically after the page value changes\n  const handlePrevPage = () => {\n    $page--;\n  };\n\n  // Turn to the next page, the request will be sent automatically after the page value changes\n  const handleNextPage = () => {\n    $page++;\n  };\n\n  // Change the number of pages, the request will be sent automatically after the pageSize value is changed\n  const handleSetPageSize = () => {\n    $pageSize = 20;\n  };\n<\/script>\n\n{#each $data as item}\n<div>\n  <span>{item.name}</span>\n</div>\n{/each}\n<button on:click="{handlePrevPage}">Previous page</button>\n<button on:click="{handleNextPage}">Next Page</button>\n<button on:click="{handleSetPageSize}">Set the number per page</button>\n<span>There are {pageCount} pages</span>\n<span>A total of {total} pieces of data</span>\n'})})})]}),"\n",(0,a.jsx)(t.h3,{id:"specify-pagination-data",children:"Specify pagination data"}),"\n",(0,a.jsxs)(t.p,{children:["The data structure returned by each paging data interface is different, so we need to tell ",(0,a.jsx)(t.code,{children:"usePagination"})," the list data and the total number of items separately, so as to help us manage the paging data."]}),"\n",(0,a.jsx)(t.p,{children:"Suppose the data format returned by your paging interface is as follows:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"interface PaginationData {\n  totalNumber: number;\n  list: any[];\n}\n"})}),"\n",(0,a.jsx)(t.p,{children:"At this point, you need to return the list data and the total number of items in the form of a function."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"usePagination((page, pageSize) => queryStudents(page, pageSize), {\n  //...\n  // highlight-start\n  total: response => response.totalNumber,\n  data: response => response.list\n  // highlight-end\n});\n"})}),"\n",(0,a.jsx)(t.p,{children:"If you don't specify the total and data callback functions, they will get data in the following ways by default."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"const total = response => response.total;\nconst data = response => response.data;\n"})}),"\n",(0,a.jsx)(t.admonition,{title:"Caution",type:"warning",children:(0,a.jsx)(t.p,{children:"The data callback function must return a list of data, indicating the data set used in paging, and total is mainly used to calculate the current page number. If no number is returned in the total callback function, it will pass whether the number of requested lists is less than the pageSize value To determine whether the current page is the last page, which is generally used for pull-down loading."})}),"\n",(0,a.jsx)(t.h3,{id:"enable-append-mode",children:"Enable append mode"}),"\n",(0,a.jsx)(t.p,{children:"By default, the original list data will be replaced when the page is turned, and the append mode will append the data of the next page to the bottom of the current list when the page is turned. A common usage scenario is to pull down to load more."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"usePagination((page, pageSize) => queryStudents(page, pageSize), {\n  //...\n  // highlight-start\n  append: true\n  // highlight-end\n});\n"})}),"\n",(0,a.jsx)(t.h3,{id:"preload-adjacent-page-data",children:"Preload adjacent page data"}),"\n",(0,a.jsx)(t.p,{children:"In order to provide a better experience for pagination, when the previous and next pages of the current page meet the conditions, it will be automatically preloaded, so that when the user turns the page, the data can be displayed directly without waiting. This is the default behavior. If you don't want to preload the data of adjacent pages, you can turn it off in the following way."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"usePagination((page, pageSize) => queryStudents(page, pageSize), {\n  //...\n  // highlight-start\n  preloadPreviousPage: false, // turn off preloading previous page data\n  preloadNextPage: false // turn off preloading next page data\n  // highlight-end\n});\n"})}),"\n",(0,a.jsxs)(t.admonition,{title:"preloading trigger conditions",type:"warning",children:[(0,a.jsx)(t.p,{children:"When preloading switch is turned on, the next page will not be loaded blindly. The following two conditions need to be met:"}),(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["Preloading is based on cache of alova. The method instance used for pagination must enable chache. By default, get requests will have 5 minutes of memory cache. If it is a non-get request or the cache is turned off globally, you also need to set the cache in this Method. In the instance, set ",(0,a.jsx)(t.code,{children:"cacheFor"})," separately to enable cache."]}),"\n",(0,a.jsxs)(t.li,{children:["Based on the ",(0,a.jsx)(t.code,{children:"total"})," and ",(0,a.jsx)(t.code,{children:"pageSize"})," parameters, it is determined that there is still data on the next page."]}),"\n"]})]}),"\n",(0,a.jsxs)(t.p,{children:["In addition to ",(0,a.jsx)(t.code,{children:"onSuccess, onError, onComplete"})," request events, when preloading is triggered, you can also know the preloading status through ",(0,a.jsx)(t.code,{children:"fetching"}),", and you can also listen to preloading request events through ",(0,a.jsx)(t.code,{children:"onFetchSuccess, onFetchError, onFetchComplete"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"const {\n  // preload state\n  fetching,\n\n  // preload success event binding function\n  onFetchSuccess,\n\n  // preload error event binding function\n  onFetchError,\n\n  // Preloading complete event binding function\n  onFetchComplete\n} = usePagination((page, pageSize) => queryStudents(page, pageSize), {\n  //...\n});\n"})}),"\n",(0,a.jsx)(t.h3,{id:"listening-filter-conditions",children:"Listening filter conditions"}),"\n",(0,a.jsxs)(t.p,{children:["In many cases, the list needs to be filtered by conditions. At this time, the re-request can be triggered through the status monitoring of ",(0,a.jsx)(t.code,{children:"usePagination"}),", which is the same as ",(0,a.jsx)(t.code,{children:"useWatcher"})," provided by alova."]}),"\n",(0,a.jsx)(t.p,{children:"For example, filter by student name, student grade."}),"\n",(0,a.jsxs)(s.Z,{groupId:"framework",children:[(0,a.jsx)(r.Z,{value:"1",label:"vue composition",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:"<template>\n  \x3c!-- highlight-start --\x3e\n  <input v-model=\"studentName\" />\n  <select v-model=\"clsName\">\n    <option value=\"1\">Class 1</option>\n    <option value=\"2\">Class 2</option>\n    <option value=\"3\">Class 3</option>\n  </select>\n  \x3c!-- highlight-end --\x3e\n  \x3c!-- ... --\x3e\n</template>\n\n<script setup>\n  import { ref } from 'vue';\n  import { queryStudents } from './api.js';\n  import { usePagination } from 'alova/client';\n\n  // search condition status\n  const studentName = ref('');\n  const clsName = ref('');\n  const {\n    //...\n  } = usePagination(\n    (page, pageSize) => queryStudents(page, pageSize, studentName.value, clsName.value),\n    {\n      //...\n      // highlight-start\n      watchingStates: [studentName, clsName]\n      // highlight-end\n    }\n  );\n<\/script>\n"})})}),(0,a.jsx)(r.Z,{value:"2",label:"react",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-jsx",children:"import { queryStudents } from './api.js';\nimport { usePagination } from 'alova/client';\n\nconst App = () => {\n   // search condition status\n   const [studentName, setStudentName] = useState('');\n   const [clsName, setClsName] = useState('');\n   const {\n     //...\n   } = usePagination(\n     (page, pageSize) => queryStudents(page, pageSize, studentName, clsName),\n     {\n       //...\n       // highlight-start\n       watchingStates: [studentName, clsName]\n       // highlight-end\n     }\n   );\n\n   return (\n     // highlight-start\n     <input value={studentName} onChange={({ target }) => setStudentName(target.value)} />\n     <select value={clsName} onChange={({ target }) => setClsName(target.value)}>\n       <option value=\"1\">Class 1</option>\n       <option value=\"2\">Class 2</option>\n       <option value=\"3\">Class 3</option>\n     </select>\n     // highlight-end\n     //...\n   );\n};\n"})})}),(0,a.jsx)(r.Z,{value:"3",label:"svelte",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:"<script>\n  import { queryStudents } from './api.js';\n  import { usePagination } from 'alova/client';\n  import { writable } from 'svelte/store';\n\n  // search condition status\n  const studentName = writable('');\n  const clsName = writable('');\n  const {\n    //...\n  } = usePagination((page, pageSize) => queryStudents(page, pageSize, $studentName, $clsName), {\n    //...\n    // highlight-start\n    watchingStates: [studentName, clsName]\n    // highlight-end\n  });\n<\/script>\n\n\x3c!-- highlight-start --\x3e\n<input bind:value=\"{studentName}\" />\n<select bind:value=\"{clsName}\">\n  <option value=\"1\">Class 1</option>\n  <option value=\"2\">Class 2</option>\n  <option value=\"3\">Class 3</option>\n</select>\n\x3c!-- highlight-end --\x3e\n\x3c!-- ... --\x3e\n"})})})]}),"\n",(0,a.jsxs)(t.p,{children:["Same as ",(0,a.jsx)(t.code,{children:"useWatcher"}),", you can also implement request debounce by specifying ",(0,a.jsx)(t.code,{children:"debounce"}),", for details, please refer to ",(0,a.jsx)(t.a,{href:"/next/api/core-hooks#usewatcher",children:"useWatcher's debounce parameter setting"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"usePagination((page, pageSize) => queryStudents(page, pageSize, studentName, clsName), {\n  //...\n  // highlight-start\n  debounce: 300 // Anti-shake parameters, in milliseconds, can also be set as an array to set the anti-shake time separately for watchingStates\n  // highlight-end\n});\n"})}),"\n",(0,a.jsxs)(t.p,{children:["It should be noted that ",(0,a.jsx)(t.code,{children:"debounce"})," is achieved by request debounce in ",(0,a.jsx)(t.a,{href:"/next/api/core-hooks#usewatcher",children:(0,a.jsx)(t.strong,{children:"useWatcher"})}),". **At the end of the monitoring state, there are two hidden monitoring states of page and pageSize, which can also be set by debounce. **"]}),"\n",(0,a.jsxs)(t.p,{children:["For example, when ",(0,a.jsx)(t.code,{children:"watchingStates"})," is set to ",(0,a.jsx)(t.code,{children:"[studentName, clsName]"}),", ",(0,a.jsx)(t.code,{children:"[studentName, clsName, page, pageSize]"})," will be monitored internally, so if you need to set anti-shake for page and pageSize, you can specify ",(0,a.jsx)(t.code,{children:" [0, 0, 500, 500]"}),"."]}),"\n",(0,a.jsx)(t.h3,{id:"close-initialization-request",children:"Close initialization request"}),"\n",(0,a.jsxs)(t.p,{children:["By default, ",(0,a.jsx)(t.code,{children:"usePagination"})," will initiate a request during initialization, but you can also use ",(0,a.jsx)(t.code,{children:"immediate"})," to turn it off, and then pass the ",(0,a.jsx)(t.code,{children:"send"})," function, or change ",(0,a.jsx)(t.code,{children:"page"})," or ",(0,a.jsx)(t.code,{children:"pageSize"}),", and ",(0,a.jsx)(t.code,{children:"watchingStates"}),", etc. state to initiate the request."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"usePagination((page, pageSize) => queryStudents(page, pageSize, studentName, clsName), {\n  //...\n  // highlight-start\n  immediate: false\n  // highlight-end\n});\n"})}),"\n",(0,a.jsx)(t.h2,{id:"list-action-functions",children:"List action functions"}),"\n",(0,a.jsx)(t.p,{children:"usePagination provides a fully functional list action function, which can achieve the same effect as the re-request list without re-requesting the list, which greatly improves the interactive experience of the page. The specific function description continues to look down!"}),"\n",(0,a.jsx)(t.h3,{id:"insert-list-item",children:"Insert list item"}),"\n",(0,a.jsx)(t.p,{children:"You can use it to insert list items to any position in the list, and it will remove the last item after insertion to ensure the same effect as re-requesting the current page data."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"/**\n * Insert data\n * If no index is passed in, it will be inserted at the front by default\n * If a list item is passed in, it will be inserted after the list item, and an error will be thrown if the list item is not in the list data\n * @param item insert item\n * @param indexOrItem insertion position (index)\n */\ndeclare function insert(item: LD[number], indexOrItem?: number | LD[number]): void;\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The following is an example of returning to the first page and then inserting list items in ",(0,a.jsx)(t.strong,{children:"non-append mode"})," (page number flipping scenario):"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"page.value = 1;\nnextTick(() => {\n  insert(newItem, 0);\n});\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The following is an example of scrolling to the top after inserting a list item in ",(0,a.jsx)(t.strong,{children:"append mode"})," (drop-down loading scene):"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"insert(newItem, 0);\nnextTick(() => {\n  window.scrollTo(0, {});\n});\n"})}),"\n",(0,a.jsxs)(t.p,{children:["You can also specify the second parameter of ",(0,a.jsx)(t.code,{children:"insert"})," as a list item. When the same reference of this list item is found, the insert item will be inserted after this list item."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"insert(newItem, afterItem);\n"})}),"\n",(0,a.jsx)(t.admonition,{title:"Caution",type:"warning",children:(0,a.jsx)(t.p,{children:"In order to make the data correct, the insert function call will clear all caches."})}),"\n",(0,a.jsx)(t.h3,{id:"remove-list-item",children:"Remove list item"}),"\n",(0,a.jsxs)(t.p,{children:["In the case that the next page has a cache, it will use the cache of the next page to add to the end of the list item after removing an item, so as to ensure the same effect as re-requesting the data of the current page. In ",(0,a.jsx)(t.strong,{children:"append mode"})," and Behave the same in ",(0,a.jsx)(t.strong,{children:"non-append mode"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"/**\n * Remove data\n * If a list item is passed in, the list item will be removed, and an error will be thrown if the list item is not in the list data\n * @param position index or list item to remove\n */\ndeclare function remove(position: number | LD[number]): void;\n"})}),"\n",(0,a.jsxs)(t.p,{children:["You can also specify the second parameter of ",(0,a.jsx)(t.code,{children:"remove"})," as a list item, and when the same reference of this list item is found, this list item will be removed."]}),"\n",(0,a.jsx)(t.p,{children:"But in the following two cases, it will re-initiate the request to refresh the data of the corresponding page:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"The next page is not cached"}),"\n",(0,a.jsx)(t.li,{children:"The data that exceeds the next page cache list item is continuously called synchronously, and the cache data is not enough to supplement the current page list."}),"\n"]}),"\n",(0,a.jsx)(t.admonition,{title:"Caution",type:"warning",children:(0,a.jsx)(t.p,{children:"In order to make the data correct, the remove function call will clear all caches."})}),"\n",(0,a.jsx)(t.h3,{id:"update-data-items",children:"Update data items"}),"\n",(0,a.jsx)(t.p,{children:"Use this function when you want to update list items."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"/**\n * Replace data\n * If the position passed in is a list item, this list item will be replaced, if the list item is not in the list data, an error will be thrown\n * @param item replacement item\n * @param position replacement position (index) or list item\n */\ndeclare function replace(\n  item: LD extends any[] ? LD[number] : any,\n  position: number | LD[number]\n): void;\n"})}),"\n",(0,a.jsxs)(t.p,{children:["You can also specify the second parameter of ",(0,a.jsx)(t.code,{children:"replace"})," as a list item, which will be replaced when an identical reference to the list item is found."]}),"\n",(0,a.jsx)(t.h3,{id:"refresh-the-data-of-the-specified-page",children:"Refresh the data of the specified page"}),"\n",(0,a.jsx)(t.p,{children:"When you do not want to update the list items locally after the data operation, but re-request the data on the server side, you can use refresh to refresh the data on any page, without resetting the list data and letting the user start browsing from the first page again."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"/**\n * Refresh the specified page number data, this function will ignore the cache to force the send request\n * If no page number is passed in, the current page will be refreshed\n * If a list item is passed in, the page where the list item is located will be refreshed\n * @param pageOrItemPage Refreshed page number or list item\n */\ndeclare function refresh(pageOrItemPage?: number | LD[number]): void;\n"})}),"\n",(0,a.jsxs)(t.p,{children:["In append mode, you can specify the parameter of ",(0,a.jsx)(t.code,{children:"refresh"})," as a list item. When the same reference of this list item is found, the data of the page number where this list item is located will be refreshed."]}),"\n",(0,a.jsx)(t.h3,{id:"manually-update-list-data",children:"Manually update list data"}),"\n",(0,a.jsxs)(t.p,{children:["Use the ",(0,a.jsx)(t.code,{children:"update"})," function to update responsive data, which is similar to ",(0,a.jsx)(t.a,{href:"/next/tutorial/client/strategy/use-request",children:"useRequest's update"}),", the only difference is that when calling ",(0,a.jsx)(t.code,{children:"update"})," to update ",(0,a.jsx)(t.code,{children:"data"}),", the list data is updated, while non-response data. This is useful when manually clearing list data without reissuing the request."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"// case list data\nupdate({\n  data: []\n});\n"})}),"\n",(0,a.jsx)(t.h3,{id:"reset-list",children:"Reset list"}),"\n",(0,a.jsx)(t.p,{children:"It will clear all caches and reload the first page."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"/**\n * Reload the list from the first page and clear the cache\n */\ndeclare function reload(): void;\n"})}),"\n",(0,a.jsx)(t.h2,{id:"api",children:"API"}),"\n",(0,a.jsx)(t.h3,{id:"hook-configuration",children:"Hook configuration"}),"\n",(0,a.jsxs)(t.p,{children:["Inherit all configurations of ",(0,a.jsx)(t.a,{href:"/next/api/core-hooks#usewatcher",children:(0,a.jsx)(t.strong,{children:"useWatcher"})}),"."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Name"}),(0,a.jsx)(t.th,{children:"Description"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Default"}),(0,a.jsx)(t.th,{children:"Version"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"initialPage"}),(0,a.jsx)(t.td,{children:"initial page number"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"1"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"initialPageSize"}),(0,a.jsx)(t.td,{children:"Initial number of data items per page"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"10"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"watchingStates"}),(0,a.jsx)(t.td,{children:"state monitoring trigger request, implemented using useWatcher"}),(0,a.jsx)(t.td,{children:"any[]"}),(0,a.jsx)(t.td,{children:"[page, pageSize]"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"debounce"}),(0,a.jsx)(t.td,{children:"The debounce parameter of state monitoring, implemented by useWatcher"}),(0,a.jsx)(t.td,{children:"number | number[]"}),(0,a.jsx)(t.td,{children:"-"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"append"}),(0,a.jsx)(t.td,{children:"Whether to enable append mode"}),(0,a.jsx)(t.td,{children:"boolean"}),(0,a.jsx)(t.td,{children:"false"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"data"}),(0,a.jsx)(t.td,{children:"Array data specifying pagination"}),(0,a.jsx)(t.td,{children:"(response: any) => any[]"}),(0,a.jsx)(t.td,{children:"response => response.data"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"total"}),(0,a.jsx)(t.td,{children:"specify the total amount of data"}),(0,a.jsx)(t.td,{children:"(response: any) => number"}),(0,a.jsx)(t.td,{children:"response => response.total"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"preloadPreviousPage"}),(0,a.jsx)(t.td,{children:"whether to preload previous page data"}),(0,a.jsx)(t.td,{children:"boolean"}),(0,a.jsx)(t.td,{children:"true"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"preloadNextPage"}),(0,a.jsx)(t.td,{children:"whether to preload next page data"}),(0,a.jsx)(t.td,{children:"boolean"}),(0,a.jsx)(t.td,{children:"true"}),(0,a.jsx)(t.td,{children:"-"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"responsive-data",children:"Responsive data"}),"\n",(0,a.jsxs)(t.p,{children:["Inherit all responsive data from ",(0,a.jsx)(t.a,{href:"/next/api/core-hooks#usewatcher",children:(0,a.jsx)(t.strong,{children:"useWatcher"})}),"."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Name"}),(0,a.jsx)(t.th,{children:"Description"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Version"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"page"}),(0,a.jsx)(t.td,{children:"Current page number, determined by initialPage"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"pageSize"}),(0,a.jsx)(t.td,{children:"The current number of pages, determined by initialPageSize"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"data"}),(0,a.jsx)(t.td,{children:"paging list array data, obtained from data configuration"}),(0,a.jsx)(t.td,{children:"any[]"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"total"}),(0,a.jsx)(t.td,{children:"The total amount of data, obtained from total configuration, can be empty"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"pageCount"}),(0,a.jsx)(t.td,{children:"The total number of pages, calculated from total and pageSize"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"isLastPage"}),(0,a.jsx)(t.td,{children:"Whether the current page is the last page, if pageCount has a value, it will be obtained by comparing pageCount and page, otherwise it will be obtained by whether the length of the list data is less than pagSize"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"fetching"}),(0,a.jsx)(t.td,{children:"whether data is being preloaded"}),(0,a.jsx)(t.td,{children:"boolean"}),(0,a.jsx)(t.td,{children:"-"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"action-function",children:"Action function"}),"\n",(0,a.jsxs)(t.p,{children:["Inherit all action functions of ",(0,a.jsx)(t.a,{href:"/next/api/core-hooks#usewatcher",children:(0,a.jsx)(t.strong,{children:"useWatcher"})}),"."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"name"}),(0,a.jsx)(t.th,{children:"description"}),(0,a.jsx)(t.th,{children:"function parameters"}),(0,a.jsx)(t.th,{children:"return value"}),(0,a.jsx)(t.th,{children:"version"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"refresh"}),(0,a.jsx)(t.td,{children:"Refresh the data of the specified page number, this function will ignore the forced sending request of the cache, in the append mode, the list item can be passed in to indicate the page number where the list item is refreshed"}),(0,a.jsx)(t.td,{children:"pageOrItemPage: Refreshed page number or list item"}),(0,a.jsx)(t.td,{children:"-"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"insert"}),(0,a.jsx)(t.td,{children:"Insert a piece of data. If no index is passed in, it will be inserted at the front by default. If a list item is passed in, it will be inserted after the list item. If the list item is not in the list data, an error will be thrown"}),(0,a.jsxs)(t.td,{children:["1. item: insert item",(0,a.jsx)("br",{}),"2. indexOrItem: insert position (index) or list item, default is 0"]}),(0,a.jsx)(t.td,{children:"-"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"remove"}),(0,a.jsx)(t.td,{children:"Remove a piece of data. When a number is passed in, it means the removed index. When the position is passed in a list item, the list item will be removed. If the list item is not in the list data, an error will be thrown"}),(0,a.jsx)(t.td,{children:"position : remove position (index) or list item"}),(0,a.jsx)(t.td,{children:"-"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"replace"}),(0,a.jsx)(t.td,{children:"Replace a piece of data. When the second parameter is passed in a number, it means the replacement index. A negative number means counting from the end. When the position passed in is a list item, the list item will be replaced. If the list item is not in the list data An error will be thrown"}),(0,a.jsxs)(t.td,{children:["1. item: replacement item",(0,a.jsx)("br",{}),"2. position: replacement position (index) or list item, when a negative number is passed in, it means counting from the end"]}),(0,a.jsx)(t.td,{children:"-"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"reload"}),(0,a.jsx)(t.td,{children:"Clear the data and re-request the first page of data"}),(0,a.jsx)(t.td,{children:"-"}),(0,a.jsx)(t.td,{children:"-"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"update"}),(0,a.jsx)(t.td,{children:"Update state data, same as alova's use hook, but update list data when updating data field"}),(0,a.jsx)(t.td,{children:"newFrontStates: new state data object"}),(0,a.jsx)(t.td,{children:"-"}),(0,a.jsx)(t.td,{children:"-"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"event",children:"Event"}),"\n",(0,a.jsxs)(t.p,{children:["Inherit all events from ",(0,a.jsx)(t.a,{href:"/next/api/core-hooks#usewatcher",children:(0,a.jsx)(t.strong,{children:"useWatcher"})}),"."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Name"}),(0,a.jsx)(t.th,{children:"Description"}),(0,a.jsx)(t.th,{children:"Callback Parameters"}),(0,a.jsx)(t.th,{children:"Version"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"onFetchSuccess"}),(0,a.jsx)(t.td,{children:"fetch success callback binding function"}),(0,a.jsx)(t.td,{children:"event: alova success event object"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"onFetchError"}),(0,a.jsx)(t.td,{children:"callback binding function for fetch failure"}),(0,a.jsx)(t.td,{children:"event: alova failure event object"}),(0,a.jsx)(t.td,{children:"-"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"onFetchComplete"}),(0,a.jsx)(t.td,{children:"callback binding function for fetch completion"}),(0,a.jsx)(t.td,{children:"event: alova completion event object"}),(0,a.jsx)(t.td,{children:"-"})]})]})]})]})}function p(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},85162:(e,t,n)=>{n.d(t,{Z:()=>r});n(67294);var a=n(90512);const i={tabItem:"tabItem_Ymn6"};var s=n(85893);function r(e){let{children:t,hidden:n,className:r}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.Z)(i.tabItem,r),hidden:n,children:t})}},74866:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(67294),i=n(90512),s=n(12466),r=n(16550),l=n(20469),d=n(91980),o=n(67392),c=n(20812);function h(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:i}}=e;return{value:t,label:n,attributes:a,default:i}}))}(n);return function(e){const t=(0,o.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function g(e){let{queryString:t=!1,groupId:n}=e;const i=(0,r.k6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,d._X)(s),(0,a.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(i.location.search);t.set(s,e),i.replace({...i.location,search:t.toString()})}),[s,i])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:i}=e,s=u(e),[r,d]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:s}))),[o,h]=g({queryString:n,groupId:i}),[m,x]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[i,s]=(0,c.Nk)(n);return[i,(0,a.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:i}),f=(()=>{const e=o??m;return p({value:e,tabValues:s})?e:null})();(0,l.Z)((()=>{f&&d(f)}),[f]);return{selectedValue:r,selectValue:(0,a.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);d(e),h(e),x(e)}),[h,x,s]),tabValues:s}}var x=n(72389);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=n(85893);function b(e){let{className:t,block:n,selectedValue:a,selectValue:r,tabValues:l}=e;const d=[],{blockElementScrollPositionUntilNextRender:o}=(0,s.o5)(),c=e=>{const t=e.currentTarget,n=d.indexOf(t),i=l[n].value;i!==a&&(o(t),r(i))},h=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=d.indexOf(e.currentTarget)+1;t=d[n]??d[0];break}case"ArrowLeft":{const n=d.indexOf(e.currentTarget)-1;t=d[n]??d[d.length-1];break}}t?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},t),children:l.map((e=>{let{value:t,label:n,attributes:s}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>d.push(e),onKeyDown:h,onClick:c,...s,className:(0,i.Z)("tabs__item",f.tabItem,s?.className,{"tabs__item--active":a===t}),children:n??t},t)}))})}function v(e){let{lazy:t,children:n,selectedValue:i}=e;const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===i));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:s.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function y(e){const t=m(e);return(0,j.jsxs)("div",{className:(0,i.Z)("tabs-container",f.tabList),children:[(0,j.jsx)(b,{...t,...e}),(0,j.jsx)(v,{...t,...e})]})}function w(e){const t=(0,x.Z)();return(0,j.jsx)(y,{...e,children:h(e.children)},String(t))}},11151:(e,t,n)=>{n.d(t,{Z:()=>l,a:()=>r});var a=n(67294);const i={},s=a.createContext(i);function r(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);